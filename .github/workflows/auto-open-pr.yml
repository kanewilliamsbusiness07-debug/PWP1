name: Auto Open PR for CI branches

on:
  push:
    branches:
      - 'ci/**'

jobs:
  create-pull-request:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pull-requests: write
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v5
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          title: "ci: Add LocalStack integration and integration tests"
          body: |
            This pull request was automatically created by the CI automation.

            Changes:
            - Add LocalStack integration job to CI to run DDB+S3 integration tests.
            - Add integration tests for PDF exports (create/list/download) and mocks for AWS clients.
            - Run YAML validator in prebuild (prebuild:ci) to prevent malformed buildspec errors.
            - Bump Node version in CI to 20.

            See `CHANGELOG.md` for details.
          base: main
          labels: automation, ci
          draft: false
